<%= render 'shared/trips_header', trip: @trip, title: 'Overview', active: 'overview' %>

<p class="fs-3"><%= @trip.description %></p>
<div class="trip-show-info-block">
  <p><strong>Time frame:  </strong><%= "#{@trip.start_date.to_s(:long)} to #{@trip.end_date.to_s(:long)}" %></p>
  <p><strong>Budget: </strong><%= @trip.budget %></p>
  <p class="card-text">
    <span class="badge bg-dark"><%= @trip.visibility_string %></span>
    <%= tag.span user_in_trip(current_user, @trip).role_string, class: class_names('badge', trip_role_bg_class(user_in_trip(current_user, @trip))) %>
    <%= tag.span @trip.status_string, class: class_names('badge', trip_status_bg_class(@trip)) %>
    <span class="like-button-group">
      <% if can? :like, @trip %>
        <% if Like.liked?(current_user, @trip) %>
          <%= link_to trip_dislike_path(@trip), method: :delete, remote: true, id: "like-link-#{@trip.id}" do %>
            <i id=<%= "like-button-#{@trip.id}" %> class="bi bi-hand-thumbs-up-fill mx-1"></i>  
          <% end %>
        <% else %>
          <%= link_to trip_like_path(@trip), method: :post, remote: true, id: "like-link-#{@trip.id}" do %>
            <i id=<%= "like-button-#{@trip.id}" %> class="bi bi-hand-thumbs-up mx-1"></i>  
          <% end %>
        <% end %>
        <span id=<%= "like-counter-#{@trip.id}" %>><%= @trip.likes_count %></span>
      <% end %>
    </span>
  </p>
</div>

<div class="trip-show-action-buttons float-end">
  <% if can? :manage, @trip %>
    <%= link_to edit_trip_path(@trip) do %>
      <i class="bi bi-pencil d-block"></i>
    <% end %>
    <%= link_to @trip, method: :delete, data: { confirm: 'Are you sure?' } do %>
      <i class="bi bi-trash d-block"></i>
    <% end %>
  <% end %>
</div>

<h2 class="display-6 mt-5 mb-4">Map</h2>
<%= render 'shared/map', waypoints: @trip.waypoints, segments: @trip.segments %>

<h2 class="display-6 mt-5 mb-4">Comments</h2>

<% if can? :new_trip, Comment %>
  <%= render 'shared/add_button', target: trip_new_comment_path(@trip), resource: 'comment' %>
<% end %>

<div class="row row-cols-1 row-cols-xl-2 g-3 my-3">
  <%= render @trip.comments.order(:id).reverse %>
</div>
